h1
  = "#{@artist.title} "
  span.details style="font-size: 0.4em"
    = "#{@artist.filename == @artist.title ? '' : @artist.filename} @ "
    a href=mb_artist_search_path(@artist.title) brainz
    '  |
    a href="https://last.fm/music/#{@artist.title}" lfm

form method="POST" action=path_to(:artist).with(@artist.id)
  ' Name:
  input type="text" name="title" value=@artist.title
  ' Romaji:
  input type="text" name="romaji" value=@artist.romaji
  input type="submit"

form method="POST" action=path_to(:artist_add_tag)
  ' Tags:
  - @artist.tags.each do |t|
    == slim :tag, locals: {tag: t, artist: @artist}
  input type="hidden" name="artist_id" value=@artist.id
  input type="text" name="tag"
  input type="submit"

a#lastfm-tags-link Show last.fm tags
div#lastfm-tags
           
javascript:       
  $(document).ready(function(){
    $('#lastfm-tags-link').click(function(){
      $.ajax({
        url: "#{path_to(:lastfm_tags).with(@artist.id)}"
      }).done(function(data){
        $('#lastfm-tags').html(data);
      });
    });
  });


- if @new_albums.count > 0
  h2. New folders

  ul
    - iter = 0
    - @new_albums.each do |a|
      li
        = a
        form method="POST" action=path_to(:albums)
          input type="hidden" name="artist_id" value=@artist.id
          input type="hidden" name="filename" value=a
          ' Year:
          input> type="text" name="year"
          ' Title:
          input> type="text" name="title"
          ' Romaji:
          input> type="text" name="romaji"
          ' Type:
          input> type="text" name="type"
          input type="submit" value="Save"

- @sorted_albums.each do |albums_group|
  - type = albums_group[:type]
  - albums = albums_group[:content]
  - next if !albums || albums.count == 0
  h2 = type

  table
    - albums.each do |a|
     tr.release-line id="release-line-#{a.id}"
       == slim :album_line, locals: {album: a}

javascript:
  $(document).on('click', '.release-edit-button', function(){
    var id = $(this).attr("data-release-id");
    $.ajax({
      url: $(this).attr("data-url"),
      method: "GET"
    }).done(function(data){
      $("#release-line-" + id).html(data);
    });
  });

  $(document).on('click', '.release-cancel-button', function(){
    var id = $(this).attr("data-release-id");
    $.ajax({
      url: $(this).attr("data-url"),
      method: "GET"
    }).done(function(data){
      $("#release-line-" + id).html(data);
    });
  });

  $(document).on('click', '.release-save-button', function(){
    var id = $(this).attr("data-release-id");
    var serialized_form = $("#release-form-" + id).serialize();
    $("#release-line-" + id + " input").prop("disabled", true);

    $.ajax({
      url: $(this).attr("data-url"),
      method: "POST",
      data: serialized_form
    }).done(function(data){
      $("#release-line-" + id).html(data);
    });
  });

  $(document).on('mouseenter', '.release-line', function(){
    var textArea = $(this).find('.title-romaji');
    textArea.text(textArea.attr("data-romaji"));
  });

  $(document).on('mouseleave', '.release-line', function(){
    var textArea = $(this).find('.title-romaji');
    textArea.text(textArea.attr("data-title"));
  });
